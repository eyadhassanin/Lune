<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Reserve a Table | LUNE Fine Dining</title>
<style>
    html, body {
        margin: 0;
        padding: 0;
        font-size: 10px;                    /* match index.html scale */
        font-family: "Montserrat", sans-serif;
        color: #fff;
        text-align: center;
        background-color: #000;
        overflow-x: hidden;
    }

    /* optional dark mode support (used by toggleSwitch) */
    body.darkMode {
        background-color: #ffffff;
        color: #000000;
    }

    /* title */
    h1 {
        font-family: "Playfair Display", serif;
        color: #d4af37;
        margin-top: 2rem;                   /* sits nicely under nav */
    }

    /* --- NAVBAR (same proportions as index.html) --- */
    nav {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        height: 7rem;
        display: flex;
        justify-content: space-around;
        align-items: center;
        z-index: 1000;
        background-color: rgb(56, 56, 56);
        border-bottom: .2rem solid whitesmoke;
        gap: 50rem;
        width: 100%;
    }

    .gap {
        gap: 15rem;
    }

    .logo {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 1rem;

        color: #d4af37;
        font-size: 2rem;
        font-family: "Playfair Display", serif;
        background: none;
        border: none;
        cursor: pointer;
        text-transform: uppercase;
        letter-spacing: 0.2rem;
        filter: drop-shadow(0 0 10px rgba(0, 0, 0, 0.4));
        transition: transform 0.3s ease, filter 0.3s ease;
    }

    .logo:hover {
        transform: scale(1.05);
        filter: drop-shadow(0 0 15px rgba(0, 0, 0, 0.6));
    }

    .logo img {
        width: 6rem;
        height: auto;
        filter: brightness(1.1);
        transition: transform 0.3s ease;
    }

    .logo:hover img {
        transform: rotate(-3deg) scale(1.05);
    }

    .toggle-container {
        width: 3rem;
        height: 3rem;
        cursor: pointer;
    }

    .toggle-ball img {
        width: 3rem;
        border-radius: 50%;
    }

    .nav-links {
        display: none;
        list-style: none;
        margin-right: 7rem;
    }

    .nav-links.show {
        display: flex;
        gap: 3rem;
    }

    .nav-links li a {
        color: rgb(247, 247, 247);
        font-size: 1.5rem;
        text-decoration: none;
        padding: 1rem;
        border-radius: 2rem;
    }

    .nav-links li a:hover {
        color: red;
        border: .2rem solid red;
    }

    /* --- TOP SECTION (sits under fixed nav) --- */
    .top-section {
        background-color: #000;
        min-height: 65vh;
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
        padding-top: 9rem;          /* space for fixed nav so content is not hidden */
    }

    /* --- FLOOR PLAN (Tables Layout) --- */
    .floor-plan {
        width: 90%;
        max-width: 1000px;
        margin: 4rem auto;
        display: grid;
        grid-template-columns: repeat(5, 1fr);
        grid-gap: 10rem;
        justify-items: center;
        position: relative;
    }

    .table-group {
        position: relative;
        width: 10rem;
        height: 10rem;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: transform 0.3s ease;
    }

    .table-group:hover {
        transform: scale(1.1);
    }

    .table {
        width: 8rem;
        height: 8rem;
        background-color: #111;
        border: 0.3rem solid #d4af37;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 500;
        color: #d4af37;
        z-index: 2;
        border-radius: 0.8rem;
    }

    .reserved .table {
        background-color: #333;
        border-color: #555;
        color: #777;
        cursor: not-allowed;
    }

    .selected .table {
        background-color: #d4af37;
        color: #000;
    }

    /* chairs around the table */
    .chair {
        width: 2.2rem;
        height: 2.2rem;
        background-color: #222;
        border: 0.2rem solid #d4af37;
        position: absolute;
        border-radius: 0.6rem;
        z-index: 1;
        transition: all 0.3s ease;
    }

    .reserved .chair {
        background-color: #444;
        border-color: #555;
    }

    .selected .chair {
        background-color: #d4af37;
        border-color: #000;
    }

    /* 2 chairs on top, 2 on bottom */
    .chair.top1 { top: -2.5rem; left: 1.5rem; }
    .chair.top2 { top: -2.5rem; right: 1.5rem; }
    .chair.bottom1 { bottom: -2.5rem; left: 1.5rem; }
    .chair.bottom2 { bottom: -2.5rem; right: 1.5rem; }

    .legend {
        display: flex;
        justify-content: center;
        gap: 2rem;
        margin-top: 1.5rem;
    }

    .legend div {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 1.4rem;
    }

    .legend span {
        width: 2rem;
        height: 2rem;
        display: inline-block;
        border-radius: 0.4rem;
    }

    .available-swatch { background-color: #111; border: 0.2rem solid #d4af37; }
    .reserved-swatch { background-color: #444; }
    .selected-swatch { background-color: #d4af37; }

    /* --- FORM SECTION --- */
    .form-section {
        margin-top: 2rem;
    }

    .form-section input,
    .form-section button {
        padding: 1rem;
        margin: 1rem;
        border: none;
        outline: none;
        font-size: 1.6rem;
        border-radius: 0.5rem;
    }

    .form-section input {
        width: 20rem;
    }

    .form-section button {
        background-color: #d4af37;
        color: #000;
        cursor: pointer;
        font-weight: 600;
    }

    /* --- BOTTOM SECTION (Image Background) --- */
    .bottom-section {
        height: 35vh;
        margin-top: 5%;
        background:
                linear-gradient(to bottom, #000 0%, rgba(0, 0, 0, 0.6) 30%, transparent 100%),
                url('dine1.jpeg') center/cover no-repeat;
        display: flex;
        justify-content: center;
        align-items: center;
        color: white;
        text-shadow: 0.2rem 0.2rem 0.6rem black;
        font-size: 2.6rem;
        font-family: "Playfair Display", serif;
    }

    /* --- RESPONSIVE NAV (mirrors index behaviour) --- */
    @media screen and (max-width: 700px) {
        nav {
            gap: 10rem;
        }

        .nav-links.show {
            display: grid;
            grid-template-columns: repeat(3, 30%);
            gap: 4rem;
            margin-right: 7rem;
        }

        .SmallHeight {
            gap: 1rem;
            height: 27rem;
            flex-direction: column;
            justify-content: space-around;
        }

        .gap {
            gap: 2rem;
        }

        .floor-plan {
            grid-template-columns: repeat(2, 1fr);
            grid-gap: 5rem;
        }
    }

</style>
</head>
<body>

<nav class="col-12 col-md-12 col-sm-12" id="nav">
    <div class="logoSection" id="logoSection">
        <button class="logo" id="menu-toggle">
            <img src="Lune.jpeg" />
        </button>
    </div>
    <ul class="nav-links" id="nav-links">
        <li><a href="index.html#first">Home</a></li>
        <li><a href="Menu.html">Menu</a></li>
        <li><a href="Gallery.html">Reservation</a></li>

        <!-- Only visible for admins -->
        <li id="admin-link" style="display:none;">
            <a href="admin-reservations.html">Admin Panel</a>
        </li>

        <!-- Shown when NOT logged in -->
        <li id="signin-link">
            <a href="signin.html">Sign In</a>
        </li>

        <!-- Shown when logged in -->
        <li id="logout-link" style="display:none;">
            <a href="#">Logout</a>
        </li>
    </ul>
    <div class="toggle-container" onclick="toggleSwitch()">
        <div class="toggle-ball">
            <img src="https://img.icons8.com/?size=100&id=GIywaBFJCJiI&format=png&color=FA5252"
                 id="ball"
                 alt="Theme Icon">
        </div>
    </div>
</nav>


  <div class="top-section">
    <h1>Reserve a Table</h1>

    <div class="floor-plan">
      <!-- 10 Tables -->
      <div class="table-group available" data-table="1">
        <div class="chair top1"></div><div class="chair top2"></div>
        <div class="chair bottom1"></div><div class="chair bottom2"></div>
        <div class="table">T1</div>
      </div>
      <div class="table-group reserved" data-table="2">
        <div class="chair top1"></div><div class="chair top2"></div>
        <div class="chair bottom1"></div><div class="chair bottom2"></div>
        <div class="table">T2</div>
      </div>
      <div class="table-group available" data-table="3">
        <div class="chair top1"></div><div class="chair top2"></div>
        <div class="chair bottom1"></div><div class="chair bottom2"></div>
        <div class="table">T3</div>
      </div>
      <div class="table-group available" data-table="4">
        <div class="chair top1"></div><div class="chair top2"></div>
        <div class="chair bottom1"></div><div class="chair bottom2"></div>
        <div class="table">T4</div>
      </div>
      <div class="table-group reserved" data-table="5">
        <div class="chair top1"></div><div class="chair top2"></div>
        <div class="chair bottom1"></div><div class="chair bottom2"></div>
        <div class="table">T5</div>
      </div>
      <div class="table-group available" data-table="6">
        <div class="chair top1"></div><div class="chair top2"></div>
        <div class="chair bottom1"></div><div class="chair bottom2"></div>
        <div class="table">T6</div>
      </div>
      <div class="table-group reserved" data-table="7">
        <div class="chair top1"></div><div class="chair top2"></div>
        <div class="chair bottom1"></div><div class="chair bottom2"></div>
        <div class="table">T7</div>
      </div>
      <div class="table-group available" data-table="8">
        <div class="chair top1"></div><div class="chair top2"></div>
        <div class="chair bottom1"></div><div class="chair bottom2"></div>
        <div class="table">T8</div>
      </div>
      <div class="table-group available" data-table="9">
        <div class="chair top1"></div><div class="chair top2"></div>
        <div class="chair bottom1"></div><div class="chair bottom2"></div>
        <div class="table">T9</div>
      </div>
      <div class="table-group reserved" data-table="10">
        <div class="chair top1"></div><div class="chair top2"></div>
        <div class="chair bottom1"></div><div class="chair bottom2"></div>
        <div class="table">T10</div>
      </div>
    </div>

    <div class="legend">
      <div><span class="available-swatch"></span> Available</div>
      <div><span class="reserved-swatch"></span> Reserved</div>
      <div><span class="selected-swatch"></span> Selected</div>
    </div>

    <div class="form-section" id="bookingForm" style="display:none;">
      <h2>Reserve Table <span id="selectedTable"></span></h2>
      <input type="text" placeholder="Your Name" id="name" />
      <input type="text" placeholder="Phone Number" id="phone" />
      <button onclick="confirmReservation()">Confirm Reservation</button>
    </div>
  </div>

  <div class="bottom-section">
    <p>Experience Luxury Dining at LUNE</p>
  </div>

  <script>
    const tableGroups = document.querySelectorAll(".table-group");
    const formSection = document.getElementById("bookingForm");
    const selectedTableSpan = document.getElementById("selectedTable");
    let selectedTable = null;

    tableGroups.forEach((group) => {
      group.addEventListener("click", () => {
        if (group.classList.contains("reserved")) return;
        tableGroups.forEach((g) => g.classList.remove("selected"));
        group.classList.add("selected");
        selectedTable = group.dataset.table;
        selectedTableSpan.textContent = " #" + selectedTable;
        formSection.style.display = "block";
      });
    });

    async function confirmReservation() {
        if (!selectedTable) return alert("Please select a table first.");

        const name = document.getElementById("name").value;
        const phone = document.getElementById("phone").value;

        if (!name || !phone) {
            alert("Please enter your name and phone number.");
            return;
        }

        // SEND TO BACKEND
        const response = await fetch("http://localhost:8080/api/reserve", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                name: name,
                phone: phone,
                tableNumber: parseInt(selectedTable)
            })
        });

        if (response.ok) {
            alert(`Table #${selectedTable} reserved for ${name}.`);

            const selected = document.querySelector(".table-group.selected");
            selected.classList.remove("available", "selected");
            selected.classList.add("reserved");
            formSection.style.display = "none";
        } else {
            alert("Failed to save reservation!");
        }
    }

    (function () {
        var navigation = document.getElementById("nav");
        var menuToggle = document.getElementById("menu-toggle");
        var links = document.getElementById("nav-links");

        if (navigation && menuToggle && links) {
            menuToggle.addEventListener("click", function () {
                links.classList.toggle("show");
                if (links.classList.contains("show")) {
                    navigation.classList.add("SmallHeight");
                    navigation.classList.add("gap");
                } else {
                    navigation.classList.remove("SmallHeight");
                    navigation.classList.remove("gap");
                }
            });
        }
    })();

    // dark mode toggle (reuses your existing logic)
    function toggleSwitch() {
        var ball = document.getElementById('ball');
        document.body.classList.toggle('darkMode');

        if (document.body.classList.contains("darkMode")) {
            ball.src = "https://img.icons8.com/?size=100&id=54382&format=png&color=FA5252";
        } else {
            ball.src = "https://img.icons8.com/?size=100&id=GIywaBFJCJiI&format=png&color=FA5252";
        }
    }

    // navbar auth logic: show Admin/Logout depending on localStorage.luneUser
    function setupAuthNavbar() {
        var adminLi  = document.getElementById("admin-link");
        var signinLi = document.getElementById("signin-link");
        var logoutLi = document.getElementById("logout-link");

        if (!adminLi || !signinLi || !logoutLi) return;

        var stored = localStorage.getItem("luneUser");
        if (!stored) {
            adminLi.style.display  = "none";
            logoutLi.style.display = "none";
            signinLi.style.display = "inline-block";
        } else {
            try {
                var user = JSON.parse(stored);

                signinLi.style.display = "none";
                logoutLi.style.display = "inline-block";

                if (user && user.role === "ADMIN") {
                    adminLi.style.display = "inline-block";
                } else {
                    adminLi.style.display = "none";
                }
            } catch (e) {
                console.error("Failed to parse luneUser", e);
                adminLi.style.display  = "none";
                logoutLi.style.display = "none";
                signinLi.style.display = "inline-block";
            }
        }

        logoutLi.addEventListener("click", function (e) {
            e.preventDefault();
            localStorage.removeItem("luneUser");
            window.location.href = "index.html";
        });
    }

    document.addEventListener("DOMContentLoaded", setupAuthNavbar);
  </script>
</body>
</html>
